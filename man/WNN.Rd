% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/WNN.R
\name{WNN}
\alias{WNN}
\title{Weighted Nearest Neighbors (WNN) for Time Series Forecasting}
\description{
The algorithm works as follows:
\enumerate{
\item Extract the last \code{w} observations from the time series as the reference pattern (CCi)
\item Slide a window of size \code{w} through the historical data to find similar patterns
\item Compute the Euclidean distance between CCi and each historical pattern (CCj)
\item Select the \code{k} nearest neighbors based on minimum distance
\item Compute a weighted average of the \code{h} values following each neighbor,
where weights are inverse-distance squared: \eqn{\alpha_j = 1 / d_j^2}
}
}
\details{
The \code{WNN} class implements a \strong{Weighted Nearest Neighbors} forecasting
algorithm for univariate time series, as described in Talavera-Llames et al. (2016).
}
\section{Mathematical Formulation}{

Given a time series with values up to \eqn{c_i}, we want to predict the next \eqn{h} values.

The reference window is defined as:
\deqn{CC_i = [c_{i-w+1}, c_{i-w+2}, \ldots, c_i]}

For each historical window \eqn{CC_j}, the Euclidean distance is:
\deqn{dist(i,j) = ||CC_i - CC_j||}

The forecast is computed as:
\deqn{\hat{C}_i = \frac{1}{\sum_{j=1}^{k} \alpha_j} \sum_{j=1}^{k} \alpha_j C_{q_j}}

where \eqn{\alpha_j = 1 / dist(CC_{q_j}, CC_i)^2}
}

\section{Usage}{


\if{html}{\out{<div class="sourceCode">}}\preformatted{wnn <- WNN$new(horizon = 10, window = 50, k = 5)
forecast <- wnn$fit_predict(tsdata)
}\if{html}{\out{</div>}}
}

\section{Hyperparameters}{

\describe{
\item{horizon}{Forecast horizon \code{h}: number of future values to predict.}
\item{window}{Window size \code{w}: number of consecutive samples for pattern matching.}
\item{k}{Number of nearest neighbors to use for weighted averaging.}
}
}

\section{Methods}{

\describe{
\item{\code{new(horizon, window, k)}}{Creates a new WNN model with specified parameters.}
\item{\code{fit_predict(tsdata)}}{Fits the model to the time series and returns the forecast.}
}
}

\examples{

## ------------------------------------------------
## Method `WNN$new`
## ------------------------------------------------

wnn <- WNN$new(horizon = 10, window = 50, k = 5)

## ------------------------------------------------
## Method `WNN$fit_predict`
## ------------------------------------------------

data <- ts(rnorm(200), frequency = 12)
wnn <- WNN$new(horizon = 12, window = 24, k = 3)
forecast <- wnn$fit_predict(data)
}
\references{
Talavera-Llames, R.L., Pérez-Chacón, R., Martínez-Ballesteros, M., Troncoso, A.,
Martínez-Álvarez, F. (2016). A Nearest Neighbours-Based Algorithm for Big Time
Series Data Forecasting. In: Hybrid Artificial Intelligent Systems. HAIS 2016.
Lecture Notes in Computer Science, vol 9648. Springer, Cham.
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-WNN-new}{\code{WNN$new()}}
\item \href{#method-WNN-fit_predict}{\code{WNN$fit_predict()}}
\item \href{#method-WNN-print}{\code{WNN$print()}}
\item \href{#method-WNN-summary}{\code{WNN$summary()}}
\item \href{#method-WNN-get_horizon}{\code{WNN$get_horizon()}}
\item \href{#method-WNN-get_window}{\code{WNN$get_window()}}
\item \href{#method-WNN-get_k}{\code{WNN$get_k()}}
\item \href{#method-WNN-get_original_data}{\code{WNN$get_original_data()}}
\item \href{#method-WNN-get_forecast}{\code{WNN$get_forecast()}}
\item \href{#method-WNN-get_distances}{\code{WNN$get_distances()}}
\item \href{#method-WNN-get_weights}{\code{WNN$get_weights()}}
\item \href{#method-WNN-clone}{\code{WNN$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-new"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-new}{}}}
\subsection{Method \code{new()}}{
Create a new WNN model
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$new(horizon, window, k)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{horizon}}{Integer. The forecast horizon (number of values to predict).}

\item{\code{window}}{Integer. The window size for pattern matching.}

\item{\code{k}}{Integer. The number of nearest neighbors to consider.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new WNN object.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{wnn <- WNN$new(horizon = 10, window = 50, k = 5)
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-fit_predict"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-fit_predict}{}}}
\subsection{Method \code{fit_predict()}}{
Fit the model and generate predictions

This method implements the WNN algorithm:
\enumerate{
\item Extracts the reference window (last w observations)
\item Finds the k nearest neighbors in the historical data
\item Computes a weighted average of their subsequent h values
}
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$fit_predict(tsdata)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{tsdata}}{A univariate time series (ts object) or numeric vector.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A time series object containing the h predicted values.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{data <- ts(rnorm(200), frequency = 12)
wnn <- WNN$new(horizon = 12, window = 24, k = 3)
forecast <- wnn$fit_predict(data)
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-print"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-print}{}}}
\subsection{Method \code{print()}}{
Print method for WNN object (brief summary)
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$print()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Invisible self
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-summary"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-summary}{}}}
\subsection{Method \code{summary()}}{
Summary method for WNN object (complete information)

Displays all information about the model including:
\itemize{
\item Hyperparameters (horizon, window, k)
\item Original data statistics (if fitted)
\item Nearest neighbor distances and weights
\item Forecast values
}
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$summary()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Invisible self
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-get_horizon"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-get_horizon}{}}}
\subsection{Method \code{get_horizon()}}{
Get the forecast horizon
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$get_horizon()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-get_window"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-get_window}{}}}
\subsection{Method \code{get_window()}}{
Get the window size
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$get_window()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-get_k"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-get_k}{}}}
\subsection{Method \code{get_k()}}{
Get the number of neighbors
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$get_k()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-get_original_data"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-get_original_data}{}}}
\subsection{Method \code{get_original_data()}}{
Get the original training data
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$get_original_data()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-get_forecast"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-get_forecast}{}}}
\subsection{Method \code{get_forecast()}}{
Get the forecast results
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$get_forecast()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-get_distances"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-get_distances}{}}}
\subsection{Method \code{get_distances()}}{
Get the distances of the k nearest neighbors
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$get_distances()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-get_weights"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-get_weights}{}}}
\subsection{Method \code{get_weights()}}{
Get the weights used for the weighted average
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$get_weights()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-WNN-clone"></a>}}
\if{latex}{\out{\hypertarget{method-WNN-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{WNN$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
